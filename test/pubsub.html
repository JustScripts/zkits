<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
  <title> 浏览器环境相关功能测试 </title>
  <style >
    
    .xx {
      position: fixed;
      z-index: -99;
      top: -100%;
      left: -100%;
    }

    
  </style>
</head>
<body>
  
  
  
</body>
<script type="module">
  import PubSub, { AnyChannel, } from "../src/pubsub/index.js";
  
  let channeName01 = 'channel01';
  let actionFn01 = function (channel, ...data) {
    console.log( channel, 'cb01', ...data );
  };
  // 001 基本功能
  /* ** 
  let token01 = PubSub.sub(channeName01, actionFn01);
  PubSub.pubAsync(channeName01, 'first', 'async');
  PubSub.pub(channeName01, 'second', 'hello');
  */
  
  // 002 立即执行订阅action 
  /* ** 
  PubSub.pubAsync(channeName01, 'first', 'async');
  PubSub.pub(channeName01, 'second', '0');
  let token02 = PubSub.sub(channeName01, actionFn01, true);
  PubSub.pub(channeName01, 'third', '1');
  */
  
  // 003 取消订阅 
  /* ** 
  */
  let channeName03 = 'channel03'
  let actionFn03 = (channel, ...msgs)=>{
    console.log(channel, 'cb03', ...msgs);
  }
  let token03 = PubSub.sub(channeName01, actionFn01);
  let token032 = PubSub.sub(channeName01, actionFn03);
  let token031 = PubSub.sub(channeName03, actionFn01);
  let token033 = PubSub.sub(channeName01, actionFn01);
  PubSub.pub(channeName01, 'first', 'aaaa');
  PubSub.pub(channeName03, 'first', 'bbbb');
  // 使用tocken清除单个订阅 
  // PubSub.clearSubs(token03);
  console.log('-------------');
  // channel清除该频道所有action 
  // PubSub.clearSubs(channeName01);
  // 清除指定的所有action
  // PubSub.clearSubs(actionFn01);
  // PubSub.clearSubs([token03]);
  // PubSub.clearSubs([channeName01]);
  // PubSub.clearSubs([actionFn01]);
  // PubSub.clearSubs([]);
  // PubSub.clearSubs(AnyChannel);
  PubSub.clearSubs(token033);
  // PubSub.clearSubs(token03);
  PubSub.pub(channeName01, 'second', 'cccc');
  PubSub.pub(channeName03, 'second', 'dddd');
  

</script>
</html>
